<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <script src="../../webcomponentsjs/webcomponents.js"></script>
    <script src="../../web-component-tester/browser.js"></script>
    <link rel="import" href="../more-route.html">
    <link rel="import" href="../more-routing.html">
  </head>
  <body>
    <template is="auto-binding">
      <more-routing driver="hash"></more-routing>
      <more-route name="user" path="/user/:userId">
        <more-route name="userSettings" path="/settings"></more-route>
        <more-route name="userProfile" path="/profile"></more-route>
      </more-route>
    </template>

    <script>
      var pages, selector;

      suite('nested route behavior', function() {
        setup(function(done) {
          async.series([
              function(cb) {
                MoreRouting.navigateTo("userSettings", {userId: 1234});
                cb();
              },
              animationFrameFlush,
            ]
            ,done);
        });

        test('navigates to nested route without specifying params', function(done) {
          async.series([
            function(cb) {
              MoreRouting.navigateTo("userProfile");
              cb();
            },
            animationFrameFlush,
            function(cb) {
              assert(MoreRouting.getRoute("user").params.userId !== undefined);
              assert(MoreRouting.getRoute("userProfile").params.userId === MoreRouting.getRoute("user").params.userId);
              cb()
            }],
            done);
        });

        test('navigates to nested route with specifying params', function(done) {
          async.series([
            function(cb) {
              MoreRouting.navigateTo("userProfile", {userId: 2345});
              cb();
            },
            animationFrameFlush,
            function(cb) {
              assert(MoreRouting.getRoute("user").params.userId == 2345);
              cb()
            }],
            done);
        });

      });
    </script>
  </body>
</html>